

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Deploying an Application &#8212; CCF  documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Issuing Commands" href="issue_commands.html" />
    <link rel="prev" title="Using Apps" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

    
    <a class="navbar-brand" href="../index.html">
      <img src="../_static/ccf.svg" class="logo" alt="logo">
    </a>
    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-11 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../introduction.html">Introduction</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../concepts.html">Concepts</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../quickstart/index.html">Start Here</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../members/index.html">Governance</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../developers/index.html">Building Apps</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../operators/index.html">Operations</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="index.html">Using Apps</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../glossary.html">Glossary</a>
        </li>
        
        
      </ul>

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/Microsoft/CCF" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>


<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
        
          
              <li class="active">
                  <a href="">Deploying an Application</a>
              </li>
          
        
          
              <li class="">
                  <a href="issue_commands.html">Issuing Commands</a>
              </li>
          
        
          
              <li class="">
                  <a href="rpc_api.html">RPC API</a>
              </li>
          
        
      
      
      
      
    </ul>

    
      <ul>
        <li>
          <a href="../../v0.10/users/deploy_app.html" class="badge">v0.10</a>
        </li>
      </ul>
      <ul>
        <li>
          <a href="deploy_app.html" class="badge">master</a>
        </li>
      </ul>
    

</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#recovering-a-service" class="nav-link">Recovering a Service</a>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/Microsoft/CCF/edit/master/doc/users/deploy_app.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="deploying-an-application">
<h1>Deploying an Application<a class="headerlink" href="#deploying-an-application" title="Permalink to this headline">Â¶</a></h1>
<p>The quickest way to deploy a CCF application is to use the <a class="reference external" href="https://github.com/microsoft/CCF/blob/master/start_test_network.sh">start_test_network.sh</a> test script, specifying the <a class="reference internal" href="../developers/index.html#building-apps"><span class="std std-ref">enclave image</span></a> to run.</p>
<p>The script creates a new test CCF network composed of 3 nodes running locally. All the governance requests required to open the network to users are automatically issued.</p>
<p>For example, deploying the <code class="docutils literal notranslate"><span class="pre">liblogging</span></code> example application:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> CCF/build
$ ../start_test_network.sh --package ./liblogging.enclave.so.signed
Setting up Python environment...
Python environment successfully setup
<span class="o">[</span><span class="m">2019</span>-10-29 <span class="m">14</span>:47:41.562<span class="o">]</span> Starting <span class="m">3</span> CCF nodes...
<span class="o">[</span><span class="m">2019</span>-10-29 <span class="m">14</span>:48:12.138<span class="o">]</span> Started CCF network with the following nodes:
<span class="o">[</span><span class="m">2019</span>-10-29 <span class="m">14</span>:48:12.138<span class="o">]</span>   Node <span class="o">[</span> <span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="m">127</span>.177.10.108:37765
<span class="o">[</span><span class="m">2019</span>-10-29 <span class="m">14</span>:48:12.138<span class="o">]</span>   Node <span class="o">[</span> <span class="m">1</span><span class="o">]</span> <span class="o">=</span> <span class="m">127</span>.169.74.37:58343
<span class="o">[</span><span class="m">2019</span>-10-29 <span class="m">14</span>:48:12.138<span class="o">]</span>   Node <span class="o">[</span> <span class="m">2</span><span class="o">]</span> <span class="o">=</span> <span class="m">127</span>.131.108.179:50532
<span class="o">[</span><span class="m">2019</span>-10-29 <span class="m">14</span>:48:12.138<span class="o">]</span> You can now issue business transactions to the ./liblogging.enclave.so.signed application.
<span class="o">[</span><span class="m">2019</span>-10-29 <span class="m">14</span>:48:12.138<span class="o">]</span> See https://microsoft.github.io/CCF/users/issue_commands.html <span class="k">for</span> more information.
<span class="o">[</span><span class="m">2019</span>-10-29 <span class="m">14</span>:48:12.138<span class="o">]</span> Press Ctrl+C to shutdown the network.
</pre></div>
</div>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>To use CCF <cite>virtual</cite> mode, the same command can be run with <code class="docutils literal notranslate"><span class="pre">TEST_ENCLAVE=virtual</span></code> set as environment variable and the virtual version of the enclave application passed to the script. For example <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">TEST_ENCLAVE=virtual</span> <span class="pre">../start_test_network.sh</span> <span class="pre">--package</span> <span class="pre">./liblogging.virtual.so</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--verbose</span></code> argument can be used to display all commands issued by operators and members to start the network.</p></li>
</ul>
</div>
<p>The log files (<code class="docutils literal notranslate"><span class="pre">out</span></code> and <code class="docutils literal notranslate"><span class="pre">err</span></code>) and ledger (<code class="docutils literal notranslate"><span class="pre">&lt;node_id&gt;.ledger</span></code>) for each CCF node can be found under <code class="docutils literal notranslate"><span class="pre">CCF/build/workspace/test_network_&lt;node_id&gt;</span></code>.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The first time the command is run, a Python virtual environment will be created. This may take a few seconds. It will not be run the next time the <code class="docutils literal notranslate"><span class="pre">start_test_network.sh</span></code> script is started.</p>
</div>
<p>In a different terminal, using the local IP address and port of the CCF nodes displayed by the command (e.g. <code class="docutils literal notranslate"><span class="pre">127.177.10.108:37765</span></code> for node <code class="docutils literal notranslate"><span class="pre">0</span></code>), it is then possible for users to <a class="reference internal" href="issue_commands.html#issuing-commands"><span class="std std-ref">issue business requests</span></a>.</p>
<div class="section" id="recovering-a-service">
<h2>Recovering a Service<a class="headerlink" href="#recovering-a-service" title="Permalink to this headline">Â¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">start_test_network.sh</span></code> script can also be used to automatically recover a defunct network, as per the steps described <a class="reference internal" href="../members/accept_recovery.html#accepting-recovery-and-submitting-shares"><span class="std std-ref">here</span></a>. The ledger to be recovered (<code class="docutils literal notranslate"><span class="pre">--ledger</span></code>) , the defunct network encryption public key (<code class="docutils literal notranslate"><span class="pre">--network-enc-pubk</span></code>) and the directory containing the members and users identities and the network encryption public key (<code class="docutils literal notranslate"><span class="pre">--common-dir</span></code>) should be passed as arguments to the script.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> CCF/build
$ cp ./workspace/test_network_0/0.ledger .
$ cp ./workspace/test_network_0/network_enc_pubk.pem .
$ ../start_test_network.sh -p liblogging.enclave.so.signed --recover --ledger <span class="m">0</span>.ledger --network-enc-pubk network_enc_pubk.pem --common-dir ./workspace/test_network_common/
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:19.746<span class="o">]</span> Starting <span class="m">3</span> CCF nodes...
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:19.746<span class="o">]</span> Recovering network from:
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:19.746<span class="o">]</span>  - Ledger: <span class="m">0</span>.ledger
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:19.746<span class="o">]</span>  - Defunct network public encryption key: network_enc_pubk.pem
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:19.746<span class="o">]</span>  - Common directory: ./workspace/test_network_common/
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:24.388<span class="o">]</span> Started CCF network with the following nodes:
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:24.388<span class="o">]</span>   Node <span class="o">[</span> <span class="m">3</span><span class="o">]</span> <span class="o">=</span> <span class="m">127</span>.191.152.111:40371
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:24.388<span class="o">]</span>   Node <span class="o">[</span> <span class="m">4</span><span class="o">]</span> <span class="o">=</span> <span class="m">127</span>.184.250.157:35113
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:24.388<span class="o">]</span>   Node <span class="o">[</span> <span class="m">5</span><span class="o">]</span> <span class="o">=</span> <span class="m">127</span>.175.51.36:34699
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:24.388<span class="o">]</span> You can now issue business transactions to the liblogging.enclave.so.signed application.
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:24.388<span class="o">]</span> See https://microsoft.github.io/CCF/users/issue_commands.html <span class="k">for</span> more information.
<span class="o">[</span><span class="m">2020</span>-05-14 <span class="m">14</span>:50:24.388<span class="o">]</span> Press Ctrl+C to shutdown the network.
</pre></div>
</div>
<p>The effects of transactions committed by the defunct network should then be recovered. Users can also <a class="reference internal" href="issue_commands.html#issuing-commands"><span class="std std-ref">issue new business requests</span></a>.</p>
<div class="alert alert-info">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--ledger-recovery-timeout</span></code> argument should be used to specify the maximum timeout (in seconds) that the script will wait for CCF to recover the ledger. Depending on the size of the ledger to recover, this timeout may have to be set to a large value.</p>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">Using Apps</a>
    <a class='right-next' id="next-link" href="issue_commands.html" title="next page">Issuing Commands</a>

              </div>
              
          </main>
          

      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2018, Microsoft Research.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>