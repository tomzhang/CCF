

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Node Output &#8212; CCF  documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Operator RPC API" href="operator_rpc_api.html" />
    <link rel="prev" title="Catastrophic Recovery" href="recovery.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

    
    <a class="navbar-brand" href="../index.html">
      <img src="../_static/ccf.svg" class="logo" alt="logo">
    </a>
    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-11 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../introduction.html">Introduction</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../concepts.html">Concepts</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../quickstart/index.html">Start Here</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../members/index.html">Governance</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../developers/index.html">Building Apps</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="index.html">Operations</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../users/index.html">Using Apps</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../glossary.html">Glossary</a>
        </li>
        
        
      </ul>

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/Microsoft/CCF" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>


<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
      
      
      
      
      
      
      
      
        
          
              <li class="">
                  <a href="start_network.html">Starting a New Network</a>
              </li>
          
        
          
              <li class="">
                  <a href="recovery.html">Catastrophic Recovery</a>
              </li>
          
        
          
              <li class="active">
                  <a href="">Node Output</a>
              </li>
          
        
          
              <li class="">
                  <a href="operator_rpc_api.html">Operator RPC API</a>
              </li>
          
        
          
              <li class="">
                  <a href="resource_usage.html">Resource Usage</a>
              </li>
          
        
      
      
      
      
      
      
    </ul>

    
      <ul>
        <li>
          <a href="../../v0.10/operators/node_output.html" class="badge">v0.10</a>
        </li>
      </ul>
      <ul>
        <li>
          <a href="node_output.html" class="badge">master</a>
        </li>
      </ul>
    

</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#json-formatting" class="nav-link">JSON Formatting</a>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/Microsoft/CCF/edit/master/doc/operators/node_output.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="node-output">
<h1>Node Output<a class="headerlink" href="#node-output" title="Permalink to this headline">¶</a></h1>
<p>By default node output is written to <code class="docutils literal notranslate"><span class="pre">stdout</span></code> and to <code class="docutils literal notranslate"><span class="pre">stderr</span></code> and can be handled accordingly.</p>
<p>To add your own lines to this output you should use the macros defined in <code class="docutils literal notranslate"><span class="pre">ds/logger.h</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">LOG_INFO_FMT</span><span class="p">(</span><span class="s">&quot;x is currently {}&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</pre></div>
</div>
<p>These macros do several things:</p>
<ul class="simple">
<li><p>Variable substition. The example above will produce a message of “x is currently 5”. See <a class="reference external" href="https://fmt.dev/latest/">libfmt</a> for more details of the formatting syntax.</p></li>
<li><p>Declare the severity of the entry. CCF defines 5 levels (<code class="docutils literal notranslate"><span class="pre">trace</span></code>, <code class="docutils literal notranslate"><span class="pre">debug</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code>, <code class="docutils literal notranslate"><span class="pre">fail</span></code>, and <code class="docutils literal notranslate"><span class="pre">fatal</span></code>), and production nodes will generally ignore entries below a specified severity</p></li>
<li><p>Prefix formatted metadata. The produced log line will include a timestamp and the name and line number where the line was produced</p></li>
<li><p>Write without an ECALL. The final write must be handled by the host, so writing directly from the enclave would require an expensive ECALL. Instead these macros will queue writes to a ringbuffer for the host to process, so diagnostic logging should not cause significant performance drops</p></li>
</ul>
<p>Note that your app’s logging entries will be interleaved (line-by-line) with the framework’s logging messages, so you may want to prefix your app’s entries so they can be more easily distinguished.</p>
<div class="section" id="json-formatting">
<h2>JSON Formatting<a class="headerlink" href="#json-formatting" title="Permalink to this headline">¶</a></h2>
<p>There is an option to further generate machine-readable logs for monitoring. To enable this pass <cite>–json-log-path &lt;path_to_file&gt;</cite> when creating a node (in either <code class="docutils literal notranslate"><span class="pre">start</span></code> or <code class="docutils literal notranslate"><span class="pre">join</span></code> mode). The generated logs will be in JSON format as displayed below.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;e_ts&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-09-02T14:47:24.589386Z&quot;</span><span class="p">,</span>
    <span class="nt">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;../src/consensus/raft/raft.h&quot;</span><span class="p">,</span>
    <span class="nt">&quot;h_ts&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-09-02T14:47:24.589384Z&quot;</span><span class="p">,</span>
    <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span>
    <span class="nt">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;Deserialising signature at 24\n&quot;</span><span class="p">,</span>
    <span class="nt">&quot;number&quot;</span><span class="p">:</span> <span class="mi">651</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e_ts</span></code> is the ISO 8601 UTC timestamp of the log if logged inside the enclave (field will be missing if line was logged on the host side)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">h_ts</span></code> is the ISO 8601 UTC timestamp of the log when logged on the host side</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> is the file the log originated from</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">number</span></code> is the line number in the file the log originated from</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">level</span></code> is the level of the log message [info, debug, trace, fail, fatal]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">msg</span></code> is the log message</p></li>
</ul>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="recovery.html" title="previous page">Catastrophic Recovery</a>
    <a class='right-next' id="next-link" href="operator_rpc_api.html" title="next page">Operator RPC API</a>

              </div>
              
          </main>
          

      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2018, Microsoft Research.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>